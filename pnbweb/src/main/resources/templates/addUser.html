<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>User Registration</title>
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="-1"/>
<link rel="stylesheet" th:href="@{|/css/portal-common.${session.tenatntId}.min.css|}" />
<script type="text/javascript" th:src="@{/js/jquery.min.js}"></script>
<script type="text/javascript" th:src="@{/js/portal-common.min.js}"></script>
</head>
<body>
<div class="response" th:if="${processResponse} != null">
		<div th:if="${processResponse.status.name() == 'FAILURE'}" th:each="message : ${processResponse.message}" th:text="${message}" class="message error"></div>
		<div th:if="${processResponse.status.name() == 'SUCCESS'}" th:each="message : ${processResponse.message}" th:text="${message}" class="message success"></div>
	</div>
<h3>Add/Update User</h3><hr/>
		<form autocomplete="off" id="addUpdateUserDetail" th:action="@{/admin/save}" th:object="${portalUser}"	method="post">			
			<small>(<span class="required">*</span>) Required fields.</small>
							<table  style="width: 450px">
								<tr>
									<td>User Id:<span class="required">*</span></td>
									<td  th:if="${portalUser.updateUserFlag} == 'N'">
										<input id="userId" class="form-control" type="text" pattern="[a-z][a-z0-9]{2,}"  title="Only lower case and number support and must contain at least 3 characters and should starts with alphabet."
											th:field="*{userId}" required="required" maxlength="25"/>
									</td>
									<td  th:if="${portalUser.updateUserFlag} == 'Y'">
										<input id="userId" class="form-control" type="text"
											th:field="*{userId}" readonly="readonly"/>
									</td>
								</tr>
								<tr>
									<td>Name:<span class="required">*</span></td>
									<td><input id="userName" class="form-control" type="text" pattern="[a-zA-Z\s]+" style="background-color: #FFF"
										th:field="*{userName}" required="required" maxlength="30" readonly="readonly" onfocus="this.removeAttribute('readonly');"/>
										<input id="updateUserFlag" class="form-control" type="hidden" th:field="*{updateUserFlag}"/>		
									</td>
								</tr>								
								<tr th:if="${(isSuperAdmin or isAdmin) and loggedUser!=portalUser.userId}">
								<td>Profile:<span class="required">*</span></td>
									<td>
										<select id="profileId" th:field="*{profileId}" class="form-control" onchange="addRole()">
											<option th:each="profile : ${profiles}" th:value="${profile.id}" th:text="${profile.desc}" ></option>
										</select>
									</td>
								</tr>
								<tr th:if="${portalUser.updateUserFlag} == 'N'">
									<td>Password:<span class="required">*</span></td>
									<td><input class="form-control" type="password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$()\\-`.+,/&quot;]).{8,}" title="Must contain at least one number and one uppercase and lowercase letter and one special character and at least 8 or more characters"
										th:field="*{password}" required="required" maxlength="20" onchange="this.setCustomValidity(this.validity.patternMismatch ? this.title : '');if(this.checkValidity()) form.confirmPassword.pattern = this.value;"
										style="background-color: #FFF" readonly="readonly" onfocus="this.removeAttribute('readonly');"/></td>
								</tr>
								<tr th:if="${portalUser.updateUserFlag} == 'N'">
									<td>Confirm Password:<span class="required">*</span></td>
									<td><input class="form-control" type="password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$()\\-`.+,/&quot;]).{8,}" title="Please enter the same Password as above"
										th:field="*{confirmPassword}" required="required" maxlength="20" onchange="this.setCustomValidity(this.validity.patternMismatch ? this.title : '');"/></td>
								</tr>
								<tr>
									<td>Email:<span class="required">*</span></td>
									<td><input id="mail" class="form-control" type="text"
										th:field="*{mail}" required="required" maxlength="50" title="account-name@domain-name.domain-extension" pattern="[A-Z0-9a-z._%+-]+@[A-Z0-9a-z.-]+\.[a-zA-Z]{2,}"/></td>
								</tr>
								<tr>
									<td>Phone Number:<span class="required">*</span></td>
									<td><input id="phoneNumber" class="form-control" maxlength="10"
										type="text" th:field="*{phoneNumber}" required="required" pattern="[789][0-9]{9}" title="10 Digits valid number required"/></td>
								</tr>
								<tr>
									<td>User Status: <span class="required">*</span></td>
									<td th:if="${(isSuperAdmin or isAdmin) and loggedUser!=portalUser.userId}">
										<select th:field="*{userStatus}" class="form-control">
										<option th:each="userStatus : ${status}" th:value="${userStatus.name()}" th:text="${userStatus.showValue()}"></option>
										</select>
									</td>
									<td th:if="${loggedUser==portalUser.userId}">
										<input id="userStatus" type="hidden" th:field="*{userStatus}" />
										<input class="form-control" type="text" th:value="*{userStatus.textValue()}" readonly="readonly"/>
									</td>
								</tr>
								
							</table>
			<div class="modal-footer">
			<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
				<table>
				<tr>
				<td  th:if="${portalUser.updateUserFlag} == 'N'">
					<button th:if="${isSuperAdmin or isAdmin}" type="submit" class="btn btn-primary" name="action" value="insert">Submit</button>
				</td>
				<td  th:if="${portalUser.updateUserFlag} == 'Y'">
					<button th:if="${isSuperAdmin or isAdmin or loggedUser==portalUser.userId}" type="submit" class="btn btn-primary" name="action" value="update">Update</button>
				</td>
				</tr>
				</table>	
			</div>
		</form>
</body>
</html>